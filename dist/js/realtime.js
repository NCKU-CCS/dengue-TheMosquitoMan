!function(t){function e(e,o,a){d3.csv(e,function(t){var e=new Date(t[t.length-1].date),o=e.toISOString().substring(0,10).replace(/-/g,"/");$(".current").text(o),$(".number").text(t.length),n(t,p);var a=["台北市","新北市","桃園市","台中市","台南市","高雄市","基隆市","新竹市","嘉義市","新竹縣","苗栗縣","彰化縣","南投縣","雲林縣","嘉義縣","屏東縣","宜蘭縣","花蓮縣","台東縣","澎湖縣"],i=[],r={};t.forEach(function(t){r.hasOwnProperty(t.city)||(r[t.city]=0),r[t.city]+=1}),a.forEach(function(t){r.hasOwnProperty(t)||(r[t]=0)});for(var c in r)i.push({city:c,value:r[c]});i.sort(function(t,e){return e.value-t.value}),drawChart(i,function(t){return'病例數：<span style="color:red">'+t.value+"</span>"},!1)}),a&&d3.json(a,function(e,o){t.drawChart(o,showDefaultTip,!0)})}function o(){r=new L.Map("map");var t="http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",e='&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>',o=(new L.TileLayer(t,{minZoom:8,maxZoom:19,attribution:e}),"pk.eyJ1IjoiYWJ6NTMzNzgiLCJhIjoiUkRleEgwVSJ9.rWFItANcHAZQ2U0ousK4cA"),n="abz53378.0klc153h";L.tileLayer("https://api.tiles.mapbox.com/v4/"+n+"/{z}/{x}/{y}.png?access_token="+o,{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a><a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/nl/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/nl/80x15.png" /></a>.'}).addTo(r),r.setView(new L.LatLng(22.86,120.5),10),s.addTo(r)}function n(t,e){l={},t.forEach(function(t){if(t.Longitude=parseFloat(t.Longitude),t.Latitude=parseFloat(t.Latitude),!(!t.Longitude||l[t.Longitude]&&l[t.Longitude][t.Latitude])){var o=L.circle([t.Latitude,t.Longitude],e.size,{fillColor:e.fillColor,color:e.color,opacity:e.opacity,clickable:!1}).addTo(r);c.push(o),l[t.Longitude]||(l[t.Longitude]={}),l[t.Longitude][t.Latitude]=!0}})}function a(){return this._div=L.DomUtil.create("div","info"),this._div.innerHTML="",this._div}function i(){return this._div.innerHTML="",this._div}e("https://s3-ap-northeast-1.amazonaws.com/static.twstat.com/dengue105.csv",null,null,null,null);var r,c=[],s=L.control(),l={},p={size:100,color:"#F44336",fillColor:"#F44336",showBig:!0,opacity:1};s.onAdd=a,s.update=i,t.initData=e,o()}(window);